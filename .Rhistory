install.packages("tidyverse")
install.packages("car")
library(tidyverse)
library(car)
library(tidyverse)
library(car)
data <- read.csv("loan_data.csv")
data_clean <- data %>%
drop_na(loan_int_rate, previous_loan_defaults_on_file) %>%
mutate(previous_loan_defaults_on_file = factor(previous_loan_defaults_on_file))
summary_stats <- data_clean %>%
group_by(previous_loan_defaults_on_file) %>%
summarise(
N = n(),
Mean_Interest_Rate = mean(loan_int_rate),
SD_Interest_Rate = sd(loan_int_rate)
)
print("--- Summary Statistics ---")
print(summary_stats)
boxplot <- ggplot(data_clean, aes(x = previous_loan_defaults_on_file, y = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_boxplot() +
labs(
title = "Comparison of Loan Interest Rates by Previous Default Status",
x = "Record of Previous Loan Defaults",
y = "Loan Interest Rate (%)"
) +
theme_minimal() +
scale_fill_manual(values = c("No" = "skyblue", "Yes" = "salmon")) +
theme(legend.position = "none")
boxplot <- ggplot(data_clean, aes(x = previous_loan_defaults_on_file, y = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_boxplot() +
labs(
title = "Comparison of Loan Interest Rates by Previous Default Status",
x = "Record of Previous Loan Defaults",
y = "Loan Interest Rate (%)"
) +
theme_minimal() +
scale_fill_manual(values = c("No" = "skyblue", "Yes" = "salmon")) +
theme(legend.position = "none")
boxplot <- ggplot(data_clean, aes(x = previous_loan_defaults_on_file, y = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_boxplot() +
labs(
title = "Comparison of Loan Interest Rates by Previous Default Status",
x = "Record of Previous Loan Defaults",
y = "Loan Interest Rate (%)"
)
boxplot <- ggplot(data_clean, aes(x = previous_loan_defaults_on_file, y = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_boxplot() +
labs(
title = "Comparison of Loan Interest Rates by Previous Default Status",
x = "Record of Previous Loan Defaults",
y = "Loan Interest Rate (%)"
) +
theme_minimal() +
scale_fill_manual(values = c("No" = "skyblue", "Yes" = "salmon")) +
theme(legend.position = "none")
ggsave("boxplot_interest_rate.png", plot = boxplot, width = 6, height = 5)
ggsave("boxplot_interest_rate.png", plot = boxplot, width = 6, height = 5)
faceted_histogram <- ggplot(data_clean, aes(x = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_histogram(binwidth = 1, color = "white") +
facet_wrap(~ previous_loan_defaults_on_file, ncol = 1) + # Separates groups into panels
labs(
title = "Distribution of Loan Interest Rates by Previous Default Status",
x = "Loan Interest Rate (%)",
y = "Frequency"
) +
theme_minimal() +
theme(legend.position = "none")
ggsave("faceted_histogram_interest_rate.png", plot = faceted_histogram, width = 6, height = 8)
data_clean$previous_loan_defaults_on_file <- factor(data_clean$previous_loan_defaults_on_file)
data_clean$previous_loan_defaults_on_file <- factor(data_clean$previous_loan_defaults_on_file)
summary_stats <- data_clean %>%
group_by(previous_loan_defaults_on_file) %>%
summarise(
N = n(),
Mean_Interest_Rate = mean(loan_int_rate),
SD_Interest_Rate = sd(loan_int_rate)
)
print("--- Summary Statistics ---")
print(summary_stats)
boxplot <- ggplot(data_clean, aes(x = previous_loan_defaults_on_file, y = loan_int_rate, fill = previous_loan_defaults_on_file)) +
geom_boxplot() +
labs(
title = "Comparison of Loan Interest Rates by Previous Default Status",
x = "Record of Previous Loan Defaults",
y = "Loan Interest Rate (%)"
) +
theme_minimal() +
scale_fill_manual(values = c("No" = "skyblue", "Yes" = "salmon")) +
theme(legend.position = "none")
ggsave("boxplot_interest_rate.png", plot = boxplot, width = 6, height = 5)
histogram <- ggplot(data_clean, aes(x = loan_int_rate)) +
geom_histogram(binwidth = 1, fill = "darkblue", color = "white") +
labs(
title = "Distribution of Loan Interest Rates",
x = "Loan Interest Rate (%)",
y = "Frequency"
) +
theme_minimal()
ggsave("histogram_interest_rate.png", plot = histogram, width = 6, height = 5)
levene_test_result <- leveneTest(loan_int_rate ~ previous_loan_defaults_on_file, data = data_clean)
print("--- Levene's Test for Homogeneity of Variances ---")
print(levene_test_result)
t_test_result <- t.test(loan_int_rate ~ previous_loan_defaults_on_file,
data = data_clean, var.equal = FALSE)
print("--- Two-Sample T-Test Result ---")
print(t_test_result)
